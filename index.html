<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¨ Ø§Ø³ØªÙˆØ¯ÙŠÙˆ Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ Ø§Ù„Ù…Ø·ÙˆØ±</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Cairo:wght@300;400;600;700;900&family=Pacifico&family=Tajawal:wght@300;400;500;700;900&family=Scheherazade+New:wght@400;700&family=Reem+Kufi:wght@400;500;600;700&family=Lalezar&family=Markazi+Text:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#6366f1',
                        'secondary': '#8b5cf6',
                        'accent': '#f59e0b',
                        'dark': '#0f0f0f',
                        'card': '#1a1a1a'
                    },
                    fontFamily: {
                        'cairo': ['Cairo', 'sans-serif'],
                        'amiri': ['Amiri', 'serif'],
                        'pacifico': ['Pacifico', 'cursive'],
                        'tajawal': ['Tajawal', 'sans-serif'],
                        'scheherazade': ['Scheherazade New', 'serif'],
                        'reem': ['Reem Kufi', 'sans-serif'],
                        'lalezar': ['Lalezar', 'cursive'],
                        'markazi': ['Markazi Text', 'serif']
                    }
                }
            }
        }
    </script>
    
    <style>
        body {
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a1a 50%, #0f0f0f 100%);
            font-family: 'Cairo', sans-serif;
        }
        
        .glass-effect {
            backdrop-filter: blur(15px);
            background: rgba(26, 26, 26, 0.85);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .canvas-container {
            background: linear-gradient(135deg, #1a1a1a, #2a2a2a);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 30px 60px rgba(0, 0, 0, 0.6);
            position: relative;
        }
        
        .canvas-container::before {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 20px;
            padding: 2px;
            background: linear-gradient(45deg, #6366f1, #8b5cf6, #f59e0b);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask-composite: exclude;
        }
        
        .control-group {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }
        
        .control-group:hover {
            background: rgba(255, 255, 255, 0.06);
            transform: translateY(-2px);
            border-color: rgba(99, 102, 241, 0.3);
        }
        
        .template-card {
            background: linear-gradient(135deg, #1a1a1a, #2a2a2a);
            border: 2px solid transparent;
            transition: all 0.3s ease;
            cursor: pointer;
            border-radius: 12px;
            padding: 16px;
            text-align: center;
        }
        
        .template-card:hover {
            border-color: #6366f1;
            transform: scale(1.05);
        }
        
        .template-card.active {
            border-color: #f59e0b;
            background: linear-gradient(135deg, #f59e0b20, #6366f120);
        }
        
        .glow-effect {
            filter: drop-shadow(0 0 var(--glow-intensity, 10px) var(--glow-color, #6366f1));
        }
        
        .gradient-text {
            background: linear-gradient(45deg, #6366f1, #8b5cf6, #f59e0b);
            background-size: 200% 200%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradient-shift 3s ease infinite;
        }
        
        @keyframes gradient-shift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        @keyframes pulse-glow {
            0%, 100% { filter: drop-shadow(0 0 5px currentColor); }
            50% { filter: drop-shadow(0 0 25px currentColor); }
        }
        
        .animate-glow {
            animation: pulse-glow 2s infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }
        
        .animate-float {
            animation: float 3s ease-in-out infinite;
        }
        
        .custom-scrollbar::-webkit-scrollbar {
            width: 8px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 4px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #6366f1, #8b5cf6);
            border-radius: 4px;
        }
        
        .merge-preview {
            width: 100%;
            height: 80px;
            border: 2px dashed #6366f1;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(99, 102, 241, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .merge-preview:hover {
            background: rgba(99, 102, 241, 0.2);
            border-color: #f59e0b;
        }
        
        .progress-bar {
            background: linear-gradient(90deg, #6366f1, #8b5cf6);
            height: 4px;
            border-radius: 2px;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body class="bg-dark text-white min-h-screen">
    
    <!-- Header -->
    <header class="glass-effect py-6 mb-8">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-reverse space-x-4">
                    <div class="w-12 h-12 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center animate-float">
                        <i class="fas fa-palette text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold gradient-text">
                            ğŸ¨ Ø§Ø³ØªÙˆØ¯ÙŠÙˆ Ø§Ù„Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ Ø§Ù„Ù…Ø·ÙˆØ±
                        </h1>
                        <p class="text-gray-400 text-sm">ØµÙ…Ù… Ø´Ø¹Ø§Ø±Ùƒ Ø¨ØªØ£Ø«ÙŠØ±Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø© ÙˆÙ…Ø¤Ø«Ø±Ø§Øª Ø§Ø­ØªØ±Ø§ÙÙŠØ©</p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-reverse space-x-3">
                    <button onclick="saveProject()" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-save mr-2"></i>Ø­ÙØ¸
                    </button>
                    <button onclick="loadProject()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-folder-open mr-2"></i>ÙØªØ­
                    </button>
                    <button onclick="undoAction()" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors">
                        <i class="fas fa-undo mr-2"></i>ØªØ±Ø§Ø¬Ø¹
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="container mx-auto px-4">
        <div class="grid lg:grid-cols-4 gap-8">
            
            <!-- Left Panel - Controls -->
            <div class="lg:col-span-1 space-y-6 custom-scrollbar" style="max-height: 80vh; overflow-y: auto;">
                
                <!-- Templates -->
                <div class="control-group">
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <i class="fas fa-star text-accent mr-2"></i>Ù‚ÙˆØ§Ù„Ø¨ Ø¬Ø§Ù‡Ø²Ø©
                    </h3>
                    <div class="grid grid-cols-2 gap-3">
                        <div class="template-card" onclick="applyTemplate('modern')">
                            <i class="fas fa-rocket text-2xl text-primary mb-2"></i>
                            <p class="text-sm">Ø¹ØµØ±ÙŠ</p>
                        </div>
                        <div class="template-card" onclick="applyTemplate('glow')">
                            <i class="fas fa-star text-2xl text-accent mb-2 animate-glow"></i>
                            <p class="text-sm">Ù…ØªÙˆÙ‡Ø¬</p>
                        </div>
                        <div class="template-card" onclick="applyTemplate('neon')">
                            <i class="fas fa-lightbulb text-2xl text-cyan-400 mb-2"></i>
                            <p class="text-sm">Ù†ÙŠÙˆÙ†</p>
                        </div>
                        <div class="template-card" onclick="applyTemplate('vintage')">
                            <i class="fas fa-camera-retro text-2xl text-amber-600 mb-2"></i>
                            <p class="text-sm">ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ</p>
                        </div>
                    </div>
                </div>

                <!-- Text Settings -->
                <div class="control-group">
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <i class="fas fa-font text-accent mr-2"></i>Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Øµ
                    </h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Ù†Øµ Ø§Ù„Ø´Ø¹Ø§Ø±</label>
                            <textarea id="textInput" class="w-full px-4 py-3 bg-gray-800 border border-gray-600 rounded-lg focus:border-primary focus:outline-none resize-none text-base" 
                                      rows="2" placeholder="Ø§ÙƒØªØ¨ Ù†ØµÙƒ Ù‡Ù†Ø§..." oninput="drawLogo()">Ø´Ø¹Ø§Ø± Ø§Ø­ØªØ±Ø§ÙÙŠ</textarea>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="block text-sm font-medium mb-2">Ø§Ù„Ø®Ø·</label>
                                <select id="fontFamily" onchange="drawLogo()" class="w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg focus:border-primary focus:outline-none text-sm">
                                    <option value="Cairo">Cairo - Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©</option>
                                    <option value="Amiri">Amiri - Ø£Ù…ÙŠØ±ÙŠ</option>
                                    <option value="Tajawal">Tajawal - ØªØ¬ÙˆØ§Ù„</option>
                                    <option value="Reem Kufi">Reem Kufi - Ø±ÙŠÙ… ÙƒÙˆÙÙŠ</option>
                                    <option value="Scheherazade New">Scheherazade - Ø´Ù‡Ø±Ø²Ø§Ø¯</option>
                                    <option value="Lalezar">Lalezar - Ù„Ø§Ù„Ù‡ Ø²Ø§Ø±</option>
                                    <option value="Markazi Text">Markazi - Ù…Ø±ÙƒØ²ÙŠ</option>
                                    <option value="Pacifico">Pacifico</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium mb-2">Ø§Ù„Ø­Ø¬Ù…</label>
                                <input type="range" id="fontSize" min="20" max="150" value="70" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                <span id="fontSizeDisplay" class="text-xs text-gray-400">70px</span>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Ø³Ù…Ø§ÙƒØ© Ø§Ù„Ø®Ø·</label>
                            <select id="fontWeight" onchange="drawLogo()" class="w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg focus:border-primary focus:outline-none text-sm">
                                <option value="300">Ø®ÙÙŠÙ</option>
                                <option value="400">Ø¹Ø§Ø¯ÙŠ</option>
                                <option value="600">Ù…ØªÙˆØ³Ø·</option>
                                <option value="700" selected>Ø¹Ø±ÙŠØ¶</option>
                                <option value="900">Ø³Ù…ÙŠÙƒ Ø¬Ø¯Ø§Ù‹</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Advanced Effects -->
                <div class="control-group">
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <i class="fas fa-magic text-accent mr-2"></i>Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø©
                    </h3>
                    
                    <div class="space-y-4">
                        <!-- Glow Effects -->
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <label class="text-sm font-medium">ØªØ£Ø«ÙŠØ± Ø§Ù„ØªÙˆÙ‡Ø¬</label>
                                <input type="checkbox" id="enableGlow" onchange="drawLogo()" class="accent-primary" />
                            </div>
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">Ø´Ø¯Ø© Ø§Ù„ØªÙˆÙ‡Ø¬</label>
                                    <input type="range" id="glowIntensity" min="0" max="50" value="15" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                    <span id="glowIntensityDisplay" class="text-xs text-gray-400">15px</span>
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">Ù„ÙˆÙ† Ø§Ù„ØªÙˆÙ‡Ø¬</label>
                                    <input type="color" id="glowColor" value="#6366f1" class="w-full h-8 rounded border-0 bg-transparent cursor-pointer" onchange="drawLogo()" />
                                </div>
                            </div>
                        </div>

                        <!-- Advanced Shadows -->
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <label class="text-sm font-medium">Ø¸Ù„Ø§Ù„ Ù…ØªÙ‚Ø¯Ù…Ø©</label>
                                <input type="checkbox" id="enableShadow" checked onchange="drawLogo()" class="accent-primary" />
                            </div>
                            <div class="grid grid-cols-3 gap-2">
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">X</label>
                                    <input type="range" id="shadowX" min="-20" max="20" value="5" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                    <span id="shadowXDisplay" class="text-xs text-gray-400">5px</span>
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">Y</label>
                                    <input type="range" id="shadowY" min="-20" max="20" value="5" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                    <span id="shadowYDisplay" class="text-xs text-gray-400">5px</span>
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">Ø¶Ø¨Ø§Ø¨ÙŠØ©</label>
                                    <input type="range" id="shadowBlur" min="0" max="30" value="10" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                    <span id="shadowBlurDisplay" class="text-xs text-gray-400">10px</span>
                                </div>
                            </div>
                            <input type="color" id="shadowColor" value="#000000" class="w-full h-8 rounded border-0 bg-transparent cursor-pointer mt-2" onchange="drawLogo()" />
                        </div>

                        <!-- Stroke/Outline -->
                        <div>
                            <div class="flex items-center justify-between mb-2">
                                <label class="text-sm font-medium">Ø­Ø¯ÙˆØ¯ Ø§Ù„Ù†Øµ</label>
                                <input type="checkbox" id="enableStroke" onchange="drawLogo()" class="accent-primary" />
                            </div>
                            <div class="grid grid-cols-2 gap-3" id="strokeControls">
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">Ø³Ù…Ø§ÙƒØ© Ø§Ù„Ø­Ø¯ÙˆØ¯</label>
                                    <input type="range" id="strokeWidth" min="1" max="15" value="3" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                    <span id="strokeWidthDisplay" class="text-xs text-gray-400">3px</span>
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">Ù„ÙˆÙ† Ø§Ù„Ø­Ø¯ÙˆØ¯</label>
                                    <input type="color" id="strokeColor" value="#000000" class="w-full h-8 rounded border-0 bg-transparent cursor-pointer" onchange="drawLogo()" />
                                </div>
                            </div>
                        </div>

                        <!-- Filters -->
                        <div>
                            <label class="block text-sm font-medium mb-2">Ø§Ù„Ù…Ø±Ø´Ø­Ø§Øª Ø§Ù„Ø¨ØµØ±ÙŠØ©</label>
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">Ø§Ù„Ø³Ø·ÙˆØ¹</label>
                                    <input type="range" id="brightness" min="50" max="200" value="100" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                    <span id="brightnessDisplay" class="text-xs text-gray-400">100%</span>
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">Ø§Ù„ØªØ¨Ø§ÙŠÙ†</label>
                                    <input type="range" id="contrast" min="50" max="200" value="100" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                    <span id="contrastDisplay" class="text-xs text-gray-400">100%</span>
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">Ø§Ù„ØªØ´Ø¨Ø¹</label>
                                    <input type="range" id="saturate" min="0" max="200" value="100" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                    <span id="saturateDisplay" class="text-xs text-gray-400">100%</span>
                                </div>
                                <div>
                                    <label class="block text-xs text-gray-400 mb-1">Ø§Ù„Ø¯ÙˆØ±Ø§Ù† Ø§Ù„Ù„ÙˆÙ†ÙŠ</label>
                                    <input type="range" id="hueRotate" min="0" max="360" value="0" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                    <span id="hueRotateDisplay" class="text-xs text-gray-400">0Â°</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Background Removal -->
                <div class="control-group">
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <i class="fas fa-scissors text-accent mr-2"></i>Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø®Ù„ÙÙŠØ©
                    </h3>
                    <div class="space-y-3">
                        <input type="file" id="bgRemovalInput" accept="image/*" class="w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-sm" />
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="removeBackground()" class="bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg text-sm">
                                <i class="fas fa-cut mr-1"></i>Ø¥Ø²Ø§Ù„Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠ
                            </button>
                            <button onclick="smartRemove()" class="bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg text-sm">
                                <i class="fas fa-brain mr-1"></i>Ø¥Ø²Ø§Ù„Ø© Ø°ÙƒÙŠ
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Image Merger -->
                <div class="control-group">
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <i class="fas fa-object-group text-accent mr-2"></i>Ø¯Ù…Ø¬ Ø§Ù„ØµÙˆØ±
                    </h3>
                    <div class="space-y-3">
                        <input type="file" id="mergeImages" multiple accept="image/*" class="w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-sm" />
                        
                        <div class="merge-preview" id="mergePreview">
                            <div class="text-center">
                                <i class="fas fa-images text-3xl text-gray-400 mb-2"></i>
                                <p class="text-sm text-gray-400">Ø§Ø®ØªØ± Ø§Ù„ØµÙˆØ± Ù„Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©</p>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-3 gap-2">
                            <button onclick="setMergeMode('horizontal')" class="bg-blue-600 hover:bg-blue-700 text-white py-2 rounded text-xs" id="mergeHorizontal">Ø£ÙÙ‚ÙŠ</button>
                            <button onclick="setMergeMode('vertical')" class="bg-gray-600 hover:bg-gray-700 text-white py-2 rounded text-xs" id="mergeVertical">Ø¹Ù…ÙˆØ¯ÙŠ</button>
                            <button onclick="setMergeMode('grid')" class="bg-gray-600 hover:bg-gray-700 text-white py-2 rounded text-xs" id="mergeGrid">Ø´Ø¨ÙƒØ©</button>
                        </div>
                        
                        <button onclick="mergeSelectedImages()" class="w-full bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg">
                            <i class="fas fa-compress-arrows-alt mr-2"></i>Ø¯Ù…Ø¬ Ø§Ù„ØµÙˆØ±
                        </button>
                    </div>
                </div>
            </div>

            <!-- Center Panel - Canvas -->
            <div class="lg:col-span-2">
                <div class="canvas-container">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-xl font-bold flex items-center">
                            <i class="fas fa-paint-brush text-accent mr-2"></i>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ØªØµÙ…ÙŠÙ…
                        </h2>
                        <div class="flex space-x-reverse space-x-3">
                            <button onclick="resetAll()" class="bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors text-sm">
                                <i class="fas fa-undo mr-2"></i>Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†
                            </button>
                            <button onclick="drawLogo()" class="bg-primary hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors text-sm">
                                <i class="fas fa-sync mr-2"></i>ØªØ­Ø¯ÙŠØ«
                            </button>
                        </div>
                    </div>
                    
                    <div class="flex justify-center">
                        <canvas id="logoCanvas" width="800" height="400" 
                                class="border-2 border-gray-600 rounded-lg shadow-2xl max-w-full h-auto bg-white"></canvas>
                    </div>

                    <!-- Canvas Controls -->
                    <div class="mt-6 flex justify-center space-x-reverse space-x-4">
                        <button onclick="zoomIn()" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-2 rounded-lg">
                            <i class="fas fa-search-plus"></i>
                        </button>
                        <button onclick="zoomOut()" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-2 rounded-lg">
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <button onclick="resetZoom()" class="bg-gray-700 hover:bg-gray-600 text-white px-3 py-2 rounded-lg">
                            <i class="fas fa-expand-arrows-alt"></i>
                        </button>
                        <span id="zoomLevel" class="bg-gray-800 text-white px-3 py-2 rounded-lg">100%</span>
                    </div>
                </div>
            </div>

            <!-- Right Panel - Colors & Position -->
            <div class="lg:col-span-1 space-y-6 custom-scrollbar" style="max-height: 80vh; overflow-y: auto;">
                
                <!-- Colors -->
                <div class="control-group">
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <i class="fas fa-palette text-accent mr-2"></i>Ø§Ù„Ø£Ù„ÙˆØ§Ù† ÙˆØ§Ù„ØªØ¯Ø±Ø¬Ø§Øª
                    </h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Ù†ÙˆØ¹ Ø§Ù„ØªÙ„ÙˆÙŠÙ†</label>
                            <select id="colorType" onchange="toggleColorMode(); drawLogo()" class="w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg focus:border-primary focus:outline-none text-sm">
                                <option value="solid">Ù„ÙˆÙ† ÙˆØ§Ø­Ø¯</option>
                                <option value="gradient">Ù…ØªØ¯Ø±Ø¬</option>
                                <option value="rainbow">Ù‚ÙˆØ³ Ù‚Ø²Ø­</option>
                            </select>
                        </div>

                        <div id="solidColorSection">
                            <label class="block text-sm font-medium mb-2">Ù„ÙˆÙ† Ø§Ù„Ù†Øµ</label>
                            <input type="color" id="textColor" value="#6366f1" class="w-full h-12 rounded-lg border border-gray-600 bg-transparent cursor-pointer" onchange="drawLogo()" />
                        </div>

                        <div id="gradientColorSection" class="hidden">
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-sm font-medium mb-2">Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£ÙˆÙ„</label>
                                    <input type="color" id="gradientColor1" value="#6366f1" class="w-full h-10 rounded border border-gray-600 bg-transparent cursor-pointer" onchange="drawLogo()" />
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø«Ø§Ù†ÙŠ</label>
                                    <input type="color" id="gradientColor2" value="#8b5cf6" class="w-full h-10 rounded border border-gray-600 bg-transparent cursor-pointer" onchange="drawLogo()" />
                                </div>
                            </div>
                            <div class="mt-3">
                                <label class="block text-sm font-medium mb-2">Ø§ØªØ¬Ø§Ù‡ Ø§Ù„ØªØ¯Ø±Ø¬</label>
                                <input type="range" id="gradientAngle" min="0" max="360" value="45" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                <span id="gradientAngleDisplay" class="text-xs text-gray-400">45Â°</span>
                            </div>
                        </div>

                        <!-- Color Presets -->
                        <div>
                            <label class="block text-sm font-medium mb-2">Ø£Ù„ÙˆØ§Ù† Ø¬Ø§Ù‡Ø²Ø©</label>
                            <div class="grid grid-cols-4 gap-2">
                                <div class="w-10 h-10 bg-white rounded-full cursor-pointer border-2 border-gray-600 hover:border-white transition-colors" onclick="setColor('#ffffff')"></div>
                                <div class="w-10 h-10 bg-black rounded-full cursor-pointer border-2 border-gray-600 hover:border-white transition-colors" onclick="setColor('#000000')"></div>
                                <div class="w-10 h-10 bg-blue-500 rounded-full cursor-pointer border-2 border-gray-600 hover:border-white transition-colors" onclick="setColor('#6366f1')"></div>
                                <div class="w-10 h-10 bg-purple-500 rounded-full cursor-pointer border-2 border-gray-600 hover:border-white transition-colors" onclick="setColor('#8b5cf6')"></div>
                                <div class="w-10 h-10 bg-yellow-500 rounded-full cursor-pointer border-2 border-gray-600 hover:border-white transition-colors" onclick="setColor('#f59e0b')"></div>
                                <div class="w-10 h-10 bg-red-500 rounded-full cursor-pointer border-2 border-gray-600 hover:border-white transition-colors" onclick="setColor('#ef4444')"></div>
                                <div class="w-10 h-10 bg-green-500 rounded-full cursor-pointer border-2 border-gray-600 hover:border-white transition-colors" onclick="setColor('#10b981')"></div>
                                <div class="w-10 h-10 bg-cyan-500 rounded-full cursor-pointer border-2 border-gray-600 hover:border-white transition-colors" onclick="setColor('#06b6d4')"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Position & Transform -->
                <div class="control-group">
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <i class="fas fa-arrows-alt text-accent mr-2"></i>Ø§Ù„Ù…ÙˆØ¶Ø¹ ÙˆØ§Ù„ØªØ­ÙˆÙŠÙ„
                    </h3>
                    <div class="space-y-4">
                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="block text-sm font-medium mb-2">ØªØ­Ø±ÙŠÙƒ Ø£ÙÙ‚ÙŠ</label>
                                <input type="range" id="moveX" min="-200" max="200" value="0" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                <span id="moveXDisplay" class="text-xs text-gray-400">0px</span>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">ØªØ­Ø±ÙŠÙƒ Ø¹Ù…ÙˆØ¯ÙŠ</label>
                                <input type="range" id="moveY" min="-100" max="100" value="0" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                <span id="moveYDisplay" class="text-xs text-gray-400">0px</span>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="block text-sm font-medium mb-2">Ø¯ÙˆØ±Ø§Ù†</label>
                                <input type="range" id="rotation" min="-180" max="180" value="0" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                <span id="rotationDisplay" class="text-xs text-gray-400">0Â°</span>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Ø§Ù„Ø´ÙØ§ÙÙŠØ©</label>
                                <input type="range" id="opacity" min="0.1" max="1" step="0.1" value="1" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                <span id="opacityDisplay" class="text-xs text-gray-400">100%</span>
                            </div>
                        </div>

                        <div class="grid grid-cols-2 gap-3">
                            <div>
                                <label class="block text-sm font-medium mb-2">ØªÙƒØ¨ÙŠØ±</label>
                                <input type="range" id="scaleX" min="0.5" max="3" step="0.1" value="1" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                <span id="scaleXDisplay" class="text-xs text-gray-400">100%</span>
                            </div>
                            <div>
                                <label class="block text-sm font-medium mb-2">Ø§Ù†Ø­Ø±Ø§Ù</label>
                                <input type="range" id="skewX" min="-45" max="45" value="0" class="w-full accent-primary" oninput="updateDisplay(); drawLogo()" />
                                <span id="skewXDisplay" class="text-xs text-gray-400">0Â°</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Background -->
                <div class="control-group">
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <i class="fas fa-image text-accent mr-2"></i>Ø§Ù„Ø®Ù„ÙÙŠØ©
                    </h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-2">Ù†ÙˆØ¹ Ø§Ù„Ø®Ù„ÙÙŠØ©</label>
                            <select id="bgType" onchange="toggleBgMode(); drawLogo()" class="w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg focus:border-primary focus:outline-none text-sm">
                                <option value="color">Ù„ÙˆÙ† ÙˆØ§Ø­Ø¯</option>
                                <option value="gradient">Ù…ØªØ¯Ø±Ø¬</option>
                                <option value="image">ØµÙˆØ±Ø©</option>
                                <option value="transparent">Ø´ÙØ§Ù</option>
                            </select>
                        </div>

                        <div id="bgColorSection">
                            <label class="block text-sm font-medium mb-2">Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ©</label>
                            <input type="color" id="bgColor" value="#ffffff" class="w-full h-12 rounded-lg border border-gray-600 bg-transparent cursor-pointer" onchange="drawLogo()" />
                        </div>

                        <div id="bgGradientSection" class="hidden">
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label class="block text-sm font-medium mb-2">Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£ÙˆÙ„</label>
                                    <input type="color" id="bgGradientColor1" value="#ffffff" class="w-full h-10 rounded border border-gray-600 bg-transparent cursor-pointer" onchange="drawLogo()" />
                                </div>
                                <div>
                                    <label class="block text-sm font-medium mb-2">Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø«Ø§Ù†ÙŠ</label>
                                    <input type="color" id="bgGradientColor2" value="#f0f0f0" class="w-full h-10 rounded border border-gray-600 bg-transparent cursor-pointer" onchange="drawLogo()" />
                                </div>
                            </div>
                        </div>

                        <div id="bgImageSection" class="hidden">
                            <input type="file" id="bgImageInput" accept="image/*" class="w-full px-4 py-2 bg-gray-800 border border-gray-600 rounded-lg text-sm" />
                        </div>
                    </div>
                </div>

                <!-- Animation -->
                <div class="control-group">
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <i class="fas fa-play text-accent mr-2"></i>Ø§Ù„Ø­Ø±ÙƒØ© ÙˆØ§Ù„Ø£Ù†ÙŠÙ…ÙŠØ´Ù†
                    </h3>
                    <div class="space-y-3">
                        <div class="grid grid-cols-2 gap-3">
                            <button onclick="animateRotate()" class="bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg text-sm">
                                <i class="fas fa-sync-alt mr-1"></i>Ø¯ÙˆØ±Ø§Ù†
                            </button>
                            <button onclick="animateScale()" class="bg-blue-600 hover:bg-blue-700 text-white py-2 rounded-lg text-sm">
                                <i class="fas fa-expand-arrows-alt mr-1"></i>ØªÙƒØ¨ÙŠØ±
                            </button>
                            <button onclick="animateGlow()" class="bg-yellow-600 hover:bg-yellow-700 text-white py-2 rounded-lg text-sm">
                                <i class="fas fa-star mr-1"></i>ØªÙˆÙ‡Ø¬
                            </button>
                            <button onclick="animateFade()" class="bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg text-sm">
                                <i class="fas fa-eye mr-1"></i>Ø§Ø®ØªÙØ§Ø¡
                            </button>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Ø³Ø±Ø¹Ø© Ø§Ù„Ø­Ø±ÙƒØ©</label>
                            <input type="range" id="animSpeed" min="0.5" max="5" step="0.5" value="2" class="w-full accent-primary" oninput="updateDisplay()" />
                            <span id="animSpeedDisplay" class="text-xs text-gray-400">2x</span>
                        </div>
                        
                        <button onclick="stopAllAnimations()" class="w-full bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg">
                            <i class="fas fa-stop mr-2"></i>Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø­Ø±ÙƒØ©
                        </button>
                    </div>
                </div>

                <!-- Export & Actions -->
                <div class="control-group">
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <i class="fas fa-download text-accent mr-2"></i>Ø§Ù„ØªØµØ¯ÙŠØ± ÙˆØ§Ù„Ø­ÙØ¸
                    </h3>
                    <div class="space-y-3">
                        <button onclick="downloadCanvas('png')" class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-medium">
                            <i class="fas fa-file-image mr-2"></i>ØªØ­Ù…ÙŠÙ„ PNG
                        </button>
                        <button onclick="downloadCanvas('jpg')" class="w-full bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-medium">
                            <i class="fas fa-file-image mr-2"></i>ØªØ­Ù…ÙŠÙ„ JPG
                        </button>
                        <button onclick="copyToClipboard()" class="w-full bg-yellow-600 hover:bg-yellow-700 text-white py-3 rounded-lg font-medium">
                            <i class="fas fa-copy mr-2"></i>Ù†Ø³Ø® Ù„Ù„Ø­Ø§ÙØ¸Ø©
                        </button>
                        
                        <div class="grid grid-cols-2 gap-3 mt-4">
                            <button onclick="randomizeAll()" class="bg-pink-600 hover:bg-pink-700 text-white py-2 rounded-lg text-sm">
                                <i class="fas fa-dice mr-1"></i>Ø¹Ø´ÙˆØ§Ø¦ÙŠ
                            </button>
                            <button onclick="addWatermark()" class="bg-indigo-600 hover:bg-indigo-700 text-white py-2 rounded-lg text-sm">
                                <i class="fas fa-signature mr-1"></i>Ø¹Ù„Ø§Ù…Ø© Ù…Ø§Ø¦ÙŠØ©
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Quick Info -->
                <div class="control-group">
                    <h3 class="text-lg font-bold mb-4 flex items-center">
                        <i class="fas fa-info-circle text-accent mr-2"></i>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø³Ø±ÙŠØ¹Ø©
                    </h3>
                    <div class="space-y-2 text-sm text-gray-300">
                        <div class="flex justify-between">
                            <span>Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯:</span>
                            <span id="canvasInfo">800 Ã— 400</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Ø§Ù„Ø®Ø·:</span>
                            <span id="fontInfo">Cairo</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Ø§Ù„Ø­Ø¬Ù…:</span>
                            <span id="sizeInfo">70px</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Ø§Ù„Ø£Ø­Ø±Ù:</span>
                            <span id="charCount">12</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 hidden">
        <div class="text-center">
            <div class="w-16 h-16 border-4 border-primary border-t-transparent rounded-full animate-spin mb-4"></div>
            <p class="text-white text-lg">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...</p>
            <div class="w-64 bg-gray-700 rounded-full h-2 mt-4">
                <div id="progressBar" class="progress-bar h-2 rounded-full" style="width: 0%"></div>
            </div>
        </div>
    </div>

    <!-- Hidden Inputs -->
    <input type="file" id="projectFileInput" accept=".json" style="display: none;" onchange="handleProjectLoad()" />

    <script>
        // Global Variables
        let bgImage = null;
        let isAnimating = false;
        let animationId = null;
        let undoStack = [];
        let redoStack = [];
        let currentZoom = 1;
        let mergeMode = 'horizontal';
        let selectedImages = [];

        // Initialize
        window.onload = function() {
            updateDisplay();
            drawLogo();
            setupEventListeners();
        };

        function setupEventListeners() {
            // Background image
            document.getElementById("bgImageInput").addEventListener("change", function (e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function (event) {
                        const img = new Image();
                        img.onload = function () {
                            bgImage = img;
                            drawLogo();
                        };
                        img.src = event.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });

            // Background removal
            document.getElementById('bgRemovalInput').addEventListener('change', handleBgRemovalUpload);
            
            // Image merger
            document.getElementById('mergeImages').addEventListener('change', handleImageMergeUpload);
        }

        function updateDisplay() {
            // Update all range displays
            document.getElementById('fontSizeDisplay').textContent = document.getElementById('fontSize').value + 'px';
            document.getElementById('glowIntensityDisplay').textContent = document.getElementById('glowIntensity').value + 'px';
            document.getElementById('shadowXDisplay').textContent = document.getElementById('shadowX').value + 'px';
            document.getElementById('shadowYDisplay').textContent = document.getElementById('shadowY').value + 'px';
            document.getElementById('shadowBlurDisplay').textContent = document.getElementById('shadowBlur').value + 'px';
            document.getElementById('strokeWidthDisplay').textContent = document.getElementById('strokeWidth').value + 'px';
            document.getElementById('brightnessDisplay').textContent = document.getElementById('brightness').value + '%';
            document.getElementById('contrastDisplay').textContent = document.getElementById('contrast').value + '%';
            document.getElementById('saturateDisplay').textContent = document.getElementById('saturate').value + '%';
            document.getElementById('hueRotateDisplay').textContent = document.getElementById('hueRotate').value + 'Â°';
            document.getElementById('moveXDisplay').textContent = document.getElementById('moveX').value + 'px';
            document.getElementById('moveYDisplay').textContent = document.getElementById('moveY').value + 'px';
            document.getElementById('rotationDisplay').textContent = document.getElementById('rotation').value + 'Â°';
            document.getElementById('gradientAngleDisplay').textContent = document.getElementById('gradientAngle').value + 'Â°';
            document.getElementById('opacityDisplay').textContent = Math.round(document.getElementById('opacity').value * 100) + '%';
            document.getElementById('scaleXDisplay').textContent = Math.round(document.getElementById('scaleX').value * 100) + '%';
            document.getElementById('skewXDisplay').textContent = document.getElementById('skewX').value + 'Â°';
            document.getElementById('animSpeedDisplay').textContent = document.getElementById('animSpeed').value + 'x';
            
            // Update info panel
            const canvas = document.getElementById('logoCanvas');
            document.getElementById('canvasInfo').textContent = canvas.width + ' Ã— ' + canvas.height;
            document.getElementById('fontInfo').textContent = document.getElementById('fontFamily').value;
            document.getElementById('sizeInfo').textContent = document.getElementById('fontSize').value + 'px';
            document.getElementById('charCount').textContent = document.getElementById('textInput').value.length;
            document.getElementById('zoomLevel').textContent = Math.round(currentZoom * 100) + '%';
        }

        function drawLogo() {
            const canvas = document.getElementById("logoCanvas");
            const ctx = canvas.getContext("2d");

            const text = document.getElementById("textInput").value || "Ø´Ø¹Ø§Ø± Ø§Ø­ØªØ±Ø§ÙÙŠ";
            const font = document.getElementById("fontFamily").value;
            const fontWeight = document.getElementById("fontWeight").value;
            const fontSize = parseInt(document.getElementById("fontSize").value);
            const colorType = document.getElementById("colorType").value;
            const textColor = document.getElementById("textColor").value;
            const gradientColor1 = document.getElementById("gradientColor1").value;
            const gradientColor2 = document.getElementById("gradientColor2").value;
            const gradientAngle = parseInt(document.getElementById("gradientAngle").value);
            
            // Effects
            const enableGlow = document.getElementById("enableGlow").checked;
            const glowIntensity = parseInt(document.getElementById("glowIntensity").value);
            const glowColor = document.getElementById("glowColor").value;
            const enableShadow = document.getElementById("enableShadow").checked;
            const shadowX = parseInt(document.getElementById("shadowX").value);
            const shadowY = parseInt(document.getElementById("shadowY").value);
            const shadowBlur = parseInt(document.getElementById("shadowBlur").value);
            const shadowColor = document.getElementById("shadowColor").value;
            const enableStroke = document.getElementById("enableStroke").checked;
            const strokeWidth = parseInt(document.getElementById("strokeWidth").value);
            const strokeColor = document.getElementById("strokeColor").value;
            
            // Transform
            const moveX = parseInt(document.getElementById("moveX").value);
            const moveY = parseInt(document.getElementById("moveY").value);
            const rotation = parseInt(document.getElementById("rotation").value);
            const opacity = parseFloat(document.getElementById("opacity").value);
            const scaleX = parseFloat(document.getElementById("scaleX").value);
            const skewX = parseInt(document.getElementById("skewX").value);
            
            // Filters
            const brightness = parseInt(document.getElementById("brightness").value);
            const contrast = parseInt(document.getElementById("contrast").value);
            const saturate = parseInt(document.getElementById("saturate").value);
            const hueRotate = parseInt(document.getElementById("hueRotate").value);
            
            // Background
            const bgType = document.getElementById("bgType").value;
            const bgColor = document.getElementById("bgColor").value;
            const bgGradientColor1 = document.getElementById("bgGradientColor1").value;
            const bgGradientColor2 = document.getElementById("bgGradientColor2").value;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Apply background
            if (bgType === 'transparent') {
                // Keep transparent
            } else if (bgType === 'image' && bgImage) {
                ctx.drawImage(bgImage, 0, 0, canvas.width, canvas.height);
            } else if (bgType === 'gradient') {
                const bgGradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                bgGradient.addColorStop(0, bgGradientColor1);
                bgGradient.addColorStop(1, bgGradientColor2);
                ctx.fillStyle = bgGradient;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            } else {
                ctx.fillStyle = bgColor;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }

            // Setup text properties
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.font = `${fontWeight} ${fontSize}px '${font}'`;
            ctx.globalAlpha = opacity;
            
            // Apply filters
            ctx.filter = `brightness(${brightness}%) contrast(${contrast}%) saturate(${saturate}%) hue-rotate(${hueRotate}deg)`;

            const x = canvas.width / 2 + moveX;
            const y = canvas.height / 2 + moveY;

            // Apply transformations
            ctx.save();
            ctx.translate(x, y);
            ctx.rotate((rotation * Math.PI) / 180);
            ctx.scale(scaleX, 1);
            ctx.transform(1, 0, Math.tan(skewX * Math.PI / 180), 1, 0, 0);

            // Apply glow effect
            if (enableGlow && glowIntensity > 0) {
                ctx.shadowColor = glowColor;
                ctx.shadowBlur = glowIntensity;
                ctx.shadowOffsetX = 0;
                ctx.shadowOffsetY = 0;
            }

            // Apply shadow
            if (enableShadow) {
                ctx.shadowOffsetX = shadowX;
                ctx.shadowOffsetY = shadowY;
                ctx.shadowBlur = shadowBlur;
                ctx.shadowColor = shadowColor;
            }

            // Draw stroke
            if (enableStroke && strokeWidth > 0) {
                ctx.lineWidth = strokeWidth;
                ctx.strokeStyle = strokeColor;
                ctx.strokeText(text, 0, 0);
                // Reset shadow for main text
                ctx.shadowOffsetX = 0;
                ctx.shadowOffsetY = 0;
                ctx.shadowBlur = 0;
            }

            // Draw main text with color/gradient
            if (colorType === 'gradient') {
                const angleRad = (gradientAngle * Math.PI) / 180;
                const gradient = ctx.createLinearGradient(
                    -fontSize * Math.cos(angleRad),
                    -fontSize * Math.sin(angleRad),
                    fontSize * Math.cos(angleRad),
                    fontSize * Math.sin(angleRad)
                );
                gradient.addColorStop(0, gradientColor1);
                gradient.addColorStop(1, gradientColor2);
                ctx.fillStyle = gradient;
            } else if (colorType === 'rainbow') {
                const gradient = ctx.createLinearGradient(-fontSize, 0, fontSize, 0);
                gradient.addColorStop(0, '#ff0000');
                gradient.addColorStop(0.17, '#ff8800');
                gradient.addColorStop(0.33, '#ffff00');
                gradient.addColorStop(0.5, '#00ff00');
                gradient.addColorStop(0.67, '#0088ff');
                gradient.addColorStop(0.83, '#0000ff');
                gradient.addColorStop(1, '#8800ff');
                ctx.fillStyle = gradient;
            } else {
                ctx.fillStyle = textColor;
            }
            
            ctx.fillText(text, 0, 0);
            ctx.restore();
            ctx.globalAlpha = 1;
            ctx.filter = 'none';

            updateDisplay();
        }

        function toggleColorMode() {
            const colorType = document.getElementById('colorType').value;
            const solidSection = document.getElementById('solidColorSection');
            const gradientSection = document.getElementById('gradientColorSection');
            
            if (colorType === 'gradient') {
                solidSection.classList.add('hidden');
                gradientSection.classList.remove('hidden');
            } else {
                solidSection.classList.remove('hidden');
                gradientSection.classList.add('hidden');
            }
        }

        function toggleBgMode() {
            const bgType = document.getElementById('bgType').value;
            const colorSection = document.getElementById('bgColorSection');
            const gradientSection = document.getElementById('bgGradientSection');
            const imageSection = document.getElementById('bgImageSection');
            
            // Hide all sections
            colorSection.classList.add('hidden');
            gradientSection.classList.add('hidden');
            imageSection.classList.add('hidden');
            
            // Show appropriate section
            if (bgType === 'color') {
                colorSection.classList.remove('hidden');
            } else if (bgType === 'gradient') {
                gradientSection.classList.remove('hidden');
            } else if (bgType === 'image') {
                imageSection.classList.remove('hidden');
            }
        }

        function setColor(color) {
            document.getElementById('textColor').value = color;
            drawLogo();
        }

        function applyTemplate(template) {
            // Remove active class from all templates
            document.querySelectorAll('.template-card').forEach(card => {
                card.classList.remove('active');
            });
            
            // Add active class to clicked template
            event.target.closest('.template-card').classList.add('active');
            
            switch(template) {
                case 'modern':
                    document.getElementById('fontFamily').value = 'Cairo';
                    document.getElementById('colorType').value = 'gradient';
                    document.getElementById('gradientColor1').value = '#6366f1';
                    document.getElementById('gradientColor2').value = '#8b5cf6';
                    document.getElementById('fontSize').value = '80';
                    document.getElementById('enableShadow').checked = true;
                    document.getElementById('shadowBlur').value = '15';
                    break;
                case 'glow':
                    document.getElementById('fontFamily').value = 'Reem Kufi';
                    document.getElementById('colorType').value = 'solid';
                    document.getElementById('textColor').value = '#ffffff';
                    document.getElementById('enableGlow').checked = true;
                    document.getElementById('glowIntensity').value = '25';
                    document.getElementById('glowColor').value = '#6366f1';
                    document.getElementById('bgColor').value = '#000000';
                    break;
                case 'neon':
                    document.getElementById('fontFamily').value = 'Lalezar';
                    document.getElementById('colorType').value = 'solid';
                    document.getElementById('textColor').value = '#00ffff';
                    document.getElementById('enableGlow').checked = true;
                    document.getElementById('glowIntensity').value = '30';
                    document.getElementById('glowColor').value = '#00ffff';
                    document.getElementById('bgColor').value = '#000000';
                    document.getElementById('enableStroke').checked = true;
                    document.getElementById('strokeColor').value = '#ffffff';
                    break;
                case 'vintage':
                    document.getElementById('fontFamily').value = 'Amiri';
                    document.getElementById('colorType').value = 'solid';
                    document.getElementById('textColor').value = '#8B4513';
                    document.getElementById('brightness').value = '90';
                    document.getElementById('contrast').value = '110';
                    document.getElementById('saturate').value = '80';
                    break;
            }
            
            toggleColorMode();
            updateDisplay();
            drawLogo();
        }

        // Animation functions
        function animateRotate() {
            if (isAnimating) {
                stopAllAnimations();
                return;
            }
            
            isAnimating = true;
            let angle = 0;
            const speed = parseFloat(document.getElementById('animSpeed').value);
            
            function animate() {
                if (!isAnimating) return;
                
                angle += speed;
                document.getElementById('rotation').value = angle % 360;
                drawLogo();
                animationId = requestAnimationFrame(animate);
            }
            
            animate();
        }

        function animateScale() {
            if (isAnimating) {
                stopAllAnimations();
                return;
            }
            
            isAnimating = true;
            let scale = 1;
            let direction = 1;
            const speed = parseFloat(document.getElementById('animSpeed').value) * 0.02;
            
            function animate() {
                if (!isAnimating) return;
                
                scale += direction * speed;
                if (scale > 1.5 || scale < 0.5) direction *= -1;
                
                document.getElementById('scaleX').value = scale;
                drawLogo();
                animationId = requestAnimationFrame(animate);
            }
            
            animate();
        }

        function animateGlow() {
            if (isAnimating) {
                stopAllAnimations();
                return;
            }
            
            isAnimating = true;
            let intensity = 10;
            let direction = 1;
            const speed = parseFloat(document.getElementById('animSpeed').value) * 2;
            
            document.getElementById('enableGlow').checked = true;
            
            function animate() {
                if (!isAnimating) return;
                
                intensity += direction * speed;
                if (intensity > 40 || intensity < 5) direction *= -1;
                
                document.getElementById('glowIntensity').value = intensity;
                drawLogo();
                animationId = requestAnimationFrame(animate);
            }
            
            animate();
        }

        function animateFade() {
            if (isAnimating) {
                stopAllAnimations();
                return;
            }
            
            isAnimating = true;
            let alpha = 1;
            let direction = -1;
            const speed = parseFloat(document.getElementById('animSpeed').value) * 0.02;
            
            function animate() {
                if (!isAnimating) return;
                
                alpha += direction * speed;
                if (alpha > 1 || alpha < 0.3) direction *= -1;
                
                document.getElementById('opacity').value = alpha;
                drawLogo();
                animationId = requestAnimationFrame(animate);
            }
            
            animate();
        }

        function stopAllAnimations() {
            isAnimating = false;
            if (animationId) {
                cancelAnimationFrame(animationId);
            }
            showNotification('ØªÙ… Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„Ø­Ø±ÙƒØ©', 'info');
        }

        // Background removal functions
        function handleBgRemovalUpload(e) {
            const file = e.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(event) {
                const img = new Image();
                img.onload = function() {
                    const canvas = document.getElementById('logoCanvas');
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
                    showNotification('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¢Ù† Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø®Ù„ÙÙŠØ©', 'success');
                };
                img.src = event.target.result;
            };
            reader.readAsDataURL(file);
        }

        function removeBackground() {
            showLoading();
            
            setTimeout(() => {
                const canvas = document.getElementById('logoCanvas');
                const ctx = canvas.getContext('2d');
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                // Simple background removal (white/light colors)
                for (let i = 0; i < data.length; i += 4) {
                    const r = data[i];
                    const g = data[i + 1];
                    const b = data[i + 2];
                    
                    // Remove white/light backgrounds
                    if (r > 240 && g > 240 && b > 240) {
                        data[i + 3] = 0; // Make transparent
                    }
                }
                
                ctx.putImageData(imageData, 0, 0);
                hideLoading();
                showNotification('ØªÙ… Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø®Ù„ÙÙŠØ© Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            }, 2000);
        }

        function smartRemove() {
            showLoading();
            
            setTimeout(() => {
                const canvas = document.getElementById('logoCanvas');
                const ctx = canvas.getContext('2d');
                const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                const data = imageData.data;
                
                // Advanced background removal using edge detection
                for (let i = 0; i < data.length; i += 4) {
                    const r = data[i];
                    const g = data[i + 1];
                    const b = data[i + 2];
                    
                    // More sophisticated background detection
                    const brightness = (r + g + b) / 3;
                    const saturation = Math.max(r, g, b) - Math.min(r, g, b);
                    
                    if (brightness > 200 && saturation < 30) {
                        data[i + 3] = 0; // Make transparent
                    }
                }
                
                ctx.putImageData(imageData, 0, 0);
                hideLoading();
                showNotification('ØªÙ… Ø§Ù„Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø°ÙƒÙŠØ© Ù„Ù„Ø®Ù„ÙÙŠØ©!', 'success');
            }, 3000);
        }

        // Image merger functions
        function handleImageMergeUpload(e) {
            const files = Array.from(e.target.files);
            selectedImages = [];
            
            if (files.length < 2) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±ØªÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ù„Ø¯Ù…Ø¬', 'warning');
                return;
            }
            
            const mergePreview = document.getElementById('mergePreview');
            mergePreview.innerHTML = `
                <div class="text-center">
                    <i class="fas fa-check-circle text-3xl text-green-400 mb-2"></i>
                    <p class="text-sm text-green-400">ØªÙ… Ø§Ø®ØªÙŠØ§Ø± ${files.length} ØµÙˆØ±</p>
                </div>
            `;
            
            // Load images
            let loadedCount = 0;
            files.forEach((file, index) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        selectedImages[index] = img;
                        loadedCount++;
                        
                        if (loadedCount === files.length) {
                            showNotification(`ØªÙ… ØªØ­Ù…ÙŠÙ„ ${files.length} ØµÙˆØ± Ø¨Ù†Ø¬Ø§Ø­`, 'success');
                        }
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            });
        }

        function setMergeMode(mode) {
            mergeMode = mode;
            
            // Update button styles
            document.querySelectorAll('[id^="merge"]').forEach(btn => {
                btn.className = btn.className.replace('bg-blue-600', 'bg-gray-600');
            });
            
            document.getElementById('merge' + mode.charAt(0).toUpperCase() + mode.slice(1)).className = 
                document.getElementById('merge' + mode.charAt(0).toUpperCase() + mode.slice(1)).className.replace('bg-gray-600', 'bg-blue-600');
        }

        function mergeSelectedImages() {
            if (selectedImages.length < 2) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±ØªÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„', 'warning');
                return;
            }
            
            showLoading();
            
            setTimeout(() => {
                const canvas = document.getElementById('logoCanvas');
                const ctx = canvas.getContext('2d');
                
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                const totalImages = selectedImages.length;
                let cols, rows;
                
                switch(mergeMode) {
                    case 'horizontal':
                        cols = totalImages;
                        rows = 1;
                        break;
                    case 'vertical':
                        cols = 1;
                        rows = totalImages;
                        break;
                    case 'grid':
                        cols = Math.ceil(Math.sqrt(totalImages));
                        rows = Math.ceil(totalImages / cols);
                        break;
                }
                
                const cellWidth = canvas.width / cols;
                const cellHeight = canvas.height / rows;
                
                selectedImages.forEach((img, index) => {
                    const col = index % cols;
                    const row = Math.floor(index / cols);
                    
                    const x = col * cellWidth;
                    const y = row * cellHeight;
                    
                    ctx.drawImage(img, x, y, cellWidth, cellHeight);
                    
                    updateProgress(((index + 1) / totalImages) * 100);
                });
                
                hideLoading();
                showNotification('ØªÙ… Ø¯Ù…Ø¬ Ø§Ù„ØµÙˆØ± Ø¨Ù†Ø¬Ø§Ø­!', 'success');
            }, 1000);
        }

        // Zoom functions
        function zoomIn() {
            currentZoom = Math.min(currentZoom * 1.2, 3);
            applyZoom();
        }

        function zoomOut() {
            currentZoom = Math.max(currentZoom / 1.2, 0.3);
            applyZoom();
        }

        function resetZoom() {
            currentZoom = 1;
            applyZoom();
        }

        function applyZoom() {
            const canvas = document.getElementById('logoCanvas');
            canvas.style.transform = `scale(${currentZoom})`;
            canvas.style.transformOrigin = 'center';
            updateDisplay();
        }

        // Utility functions
        function randomizeAll() {
            // Randomize colors
            const colors = ['#ef4444', '#f59e0b', '#10b981', '#06b6d4', '#6366f1', '#8b5cf6', '#ec4899'];
            document.getElementById('textColor').value = colors[Math.floor(Math.random() * colors.length)];
            
            // Randomize font
            const fonts = ['Cairo', 'Amiri', 'Tajawal', 'Reem Kufi', 'Lalezar'];
            document.getElementById('fontFamily').value = fonts[Math.floor(Math.random() * fonts.length)];
            
            // Randomize effects
            document.getElementById('enableGlow').checked = Math.random() > 0.5;
            document.getElementById('glowIntensity').value = Math.floor(Math.random() * 30) + 10;
            document.getElementById('rotation').value = Math.floor(Math.random() * 360) - 180;
            
            drawLogo();
            updateDisplay();
            showNotification('ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠ!', 'success');
        }

        function addWatermark() {
            const text = prompt('Ø£Ø¯Ø®Ù„ Ù†Øµ Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠØ©:') || 'Ø¹Ù„Ø§Ù…Ø© Ù…Ø§Ø¦ÙŠØ©';
            const canvas = document.getElementById('logoCanvas');
            const ctx = canvas.getContext('2d');
            
            ctx.save();
            ctx.globalAlpha = 0.3;
            ctx.font = '16px Cairo';
            ctx.fillStyle = '#888888';
            ctx.textAlign = 'right';
            ctx.fillText(text, canvas.width - 10, canvas.height - 10);
            ctx.restore();
            
            showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…Ø§Ø¦ÙŠØ©', 'success');
        }

        function downloadCanvas(format = 'png') {
            const canvas = document.getElementById("logoCanvas");
            const link = document.createElement("a");
            const filename = `logo_${Date.now()}`;
            
            const mimeType = format === 'jpg' ? 'image/jpeg' : 'image/png';
            link.href = canvas.toDataURL(mimeType, 0.9);
            link.download = filename + '.' + format;
            link.click();
            
            showNotification(`ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ø¹Ø§Ø± Ø¨ØµÙŠØºØ© ${format.toUpperCase()}`, 'success');
        }

        function copyToClipboard() {
            const canvas = document.getElementById("logoCanvas");
            canvas.toBlob(function(blob) {
                const item = new ClipboardItem({ "image/png": blob });
                navigator.clipboard.write([item]).then(() => {
                    showNotification('ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø´Ø¹Ø§Ø± Ù„Ù„Ø­Ø§ÙØ¸Ø©!', 'success');
                }).catch(() => {
                    showNotification('ÙØ´Ù„ ÙÙŠ Ø§Ù„Ù†Ø³Ø®', 'error');
                });
            });
        }

        function resetAll() {
            // Reset all controls to default values
            document.getElementById('textInput').value = 'Ø´Ø¹Ø§Ø± Ø§Ø­ØªØ±Ø§ÙÙŠ';
            document.getElementById('fontFamily').value = 'Cairo';
            document.getElementById('fontSize').value = '70';
            document.getElementById('fontWeight').value = '700';
            document.getElementById('colorType').value = 'solid';
            document.getElementById('textColor').value = '#6366f1';
            document.getElementById('enableGlow').checked = false;
            document.getElementById('enableShadow').checked = true;
            document.getElementById('enableStroke').checked = false;
            document.getElementById('moveX').value = '0';
            document.getElementById('moveY').value = '0';
            document.getElementById('rotation').value = '0';
            document.getElementById('opacity').value = '1';
            document.getElementById('scaleX').value = '1';
            document.getElementById('skewX').value = '0';
            document.getElementById('brightness').value = '100';
            document.getElementById('contrast').value = '100';
            document.getElementById('saturate').value = '100';
            document.getElementById('hueRotate').value = '0';
            document.getElementById('bgType').value = 'color';
            document.getElementById('bgColor').value = '#ffffff';
            
            // Clear background image
            bgImage = null;
            
            // Reset UI states
            toggleColorMode();
            toggleBgMode();
            updateDisplay();
            drawLogo();
            
            showNotification('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª!', 'info');
        }

        // Project management
        function saveProject() {
            const projectData = {
                // Text settings
                textInput: document.getElementById('textInput').value,
                fontFamily: document.getElementById('fontFamily').value,
                fontSize: document.getElementById('fontSize').value,
                fontWeight: document.getElementById('fontWeight').value,
                
                // Colors
                colorType: document.getElementById('colorType').value,
                textColor: document.getElementById('textColor').value,
                gradientColor1: document.getElementById('gradientColor1').value,
                gradientColor2: document.getElementById('gradientColor2').value,
                gradientAngle: document.getElementById('gradientAngle').value,
                
                // Effects
                enableGlow: document.getElementById('enableGlow').checked,
                glowIntensity: document.getElementById('glowIntensity').value,
                glowColor: document.getElementById('glowColor').value,
                enableShadow: document.getElementById('enableShadow').checked,
                shadowX: document.getElementById('shadowX').value,
                shadowY: document.getElementById('shadowY').value,
                shadowBlur: document.getElementById('shadowBlur').value,
                shadowColor: document.getElementById('shadowColor').value,
                enableStroke: document.getElementById('enableStroke').checked,
                strokeWidth: document.getElementById('strokeWidth').value,
                strokeColor: document.getElementById('strokeColor').value,
                
                // Transform
                moveX: document.getElementById('moveX').value,
                moveY: document.getElementById('moveY').value,
                rotation: document.getElementById('rotation').value,
                opacity: document.getElementById('opacity').value,
                scaleX: document.getElementById('scaleX').value,
                skewX: document.getElementById('skewX').value,
                
                // Filters
                brightness: document.getElementById('brightness').value,
                contrast: document.getElementById('contrast').value,
                saturate: document.getElementById('saturate').value,
                hueRotate: document.getElementById('hueRotate').value,
                
                // Background
                bgType: document.getElementById('bgType').value,
                bgColor: document.getElementById('bgColor').value,
                bgGradientColor1: document.getElementById('bgGradientColor1').value,
                bgGradientColor2: document.getElementById('bgGradientColor2').value,
                
                // Canvas
                canvasWidth: document.getElementById('logoCanvas').width,
                canvasHeight: document.getElementById('logoCanvas').height
            };
            
            const blob = new Blob([JSON.stringify(projectData, null, 2)], { type: 'application/json' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `logo_project_${Date.now()}.json`;
            link.click();
            
            showNotification('ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹!', 'success');
        }

        function loadProject() {
            document.getElementById('projectFileInput').click();
        }

        function handleProjectLoad(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const projectData = JSON.parse(e.target.result);
                    
                    // Apply all settings
                    Object.keys(projectData).forEach(key => {
                        const element = document.getElementById(key);
                        if (element) {
                            if (element.type === 'checkbox') {
                                element.checked = projectData[key];
                            } else if (key === 'canvasWidth' || key === 'canvasHeight') {
                                // Handle canvas size separately
                                const canvas = document.getElementById('logoCanvas');
                                if (key === 'canvasWidth') canvas.width = projectData[key];
                                if (key === 'canvasHeight') canvas.height = projectData[key];
                            } else {
                                element.value = projectData[key];
                            }
                        }
                    });
                    
                    toggleColorMode();
                    toggleBgMode();
                    updateDisplay();
                    drawLogo();
                    
                    showNotification('ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                } catch (error) {
                    showNotification('Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹', 'error');
                }
            };
            reader.readAsText(file);
        }

        function undoAction() {
            // Implementation for undo functionality
            showNotification('ÙˆØ¸ÙŠÙØ© Ø§Ù„ØªØ±Ø§Ø¬Ø¹ Ù‚ÙŠØ¯ Ø§Ù„ØªØ·ÙˆÙŠØ±', 'info');
        }

        // Utility functions for UI
        function showLoading() {
            document.getElementById('loadingOverlay').classList.remove('hidden');
            updateProgress(0);
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.add('hidden');
        }

        function updateProgress(percent) {
            document.getElementById('progressBar').style.width = percent + '%';
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg max-w-sm transform transition-all duration-300 translate-x-full`;
            
            const colors = {
                success: 'bg-green-600 text-white',
                error: 'bg-red-600 text-white',
                info: 'bg-blue-600 text-white',
                warning: 'bg-yellow-600 text-white'
            };
            
            notification.className += ` ${colors[type]}`;
            notification.innerHTML = `
                <div class="flex items-center">
                    <i class="fas fa-${type === 'success' ? 'check' : type === 'error' ? 'times' : type === 'warning' ? 'exclamation' : 'info'} mr-2"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(notification);
            
            setTimeout(() => notification.classList.remove('translate-x-full'), 100);
            setTimeout(() => {
                notification.classList.add('translate-x-full');
                setTimeout(() => document.body.removeChild(notification), 300);
            }, 3000);
        }
    </script>
</body>
</html>
